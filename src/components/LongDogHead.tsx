import React from 'react';
import { View, StyleSheet, Image } from 'react-native';
import HeadSvg from '../icons/LongdogHead';

interface LongDogHeadProps {
  color?: string;
  expression?: 'normal' | 'smile' | 'sad';
}

export const LongDogHead: React.FC<LongDogHeadProps> = ({ 
  color: _color = '#F85E3F',
  expression = 'normal'
}) => {
  // 画像ファイルを使用する場合
  const getImageSource = () => {
    switch (expression) {
      case 'smile':
        // smile画像が存在しない場合は通常画像を使用
        return require('../../assets/simple/longdog_head.png');
      case 'sad':
        return require('../../assets/simple/longdog_head_sad.png');
      default:
        return require('../../assets/simple/longdog_head.png');
    }
  };

  // 画像ファイルを使用する場合のレンダリング
  if (expression !== 'normal' || true) { // 画像ファイルを優先的に使用
    return (
      <View style={styles.container}>
        <Image
          source={getImageSource()}
          style={styles.image}
          resizeMode="contain"
        />
      </View>
    );
  }

  // SVGを使用する場合（フォールバック）
  const isComponent = typeof HeadSvg === 'function' || (typeof HeadSvg === 'object' && HeadSvg !== null);
  if (isComponent) {
    // @ts-ignore - generated component props are compatible with react-native-svg
    return (
      <View style={styles.container}>
        <HeadSvg width={160} height={120} preserveAspectRatio="xMinYMid meet" />
      </View>
    );
  }

  // Fallback: inline SVG to avoid blank screen when transformer is inactive
  const headSvg = `
<svg width="331" height="292" viewBox="0 0 331 292" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M71.6397 18.9736C107.466 -5.43968 158.4 -5.38634 194.04 19.3203C214.173 33.4137 227.44 55.2134 237.413 77.2266C243.92 92.7199 249.426 108.64 248.453 125.68C275.941 126.422 303.477 126.188 331 125.788V135.542C302.464 135.901 273.893 136.144 245.439 134.854C243.093 138.507 240.853 142.026 237.8 145.133C229.04 154.173 215.106 157.734 203.053 154.16C192.36 151.173 183.253 143.146 179.319 132.72C174.88 121.387 175.36 107.6 176.56 95.6934C177.44 88.88 178.093 81.8529 179.986 75.2529C180.88 72.373 183.854 69.6661 186.934 71.3994C189.32 72.626 190.013 74.3332 189.427 76.9463C186.56 92.0261 182.933 109.933 186.746 125.053C189.333 135.426 197.587 143.72 208.307 145.293C219.813 147.266 231.92 141.44 236.587 130.56C240.307 122.546 239.04 112.987 236.96 104.707C233.04 89.547 226.466 74.9064 218.626 61.3731C208.679 43.9999 195.293 29.1462 177.093 20.2529C142.56 3.87984 97.7462 7.66706 68.5996 33.2803C58.4265 41.8135 49.12 53.3732 46.2666 66.5996C42.92 81.5196 42.7195 97.1998 35.7862 111.106C31.6395 119.493 27.9869 127.386 28.8535 137.026C29.7202 147.88 36.1729 156.987 44.7862 163.267C54.6928 170.227 65.9596 174.334 77.7862 176.667C80.2262 177.374 83.8797 177.68 85.6797 179.627C87.7462 182.52 87.6933 186.92 87.92 190.333C88.5066 207.226 89.3602 224.107 90.2002 241C90.2936 243.973 90.4799 247.32 89.6133 250.187C86.6933 253.133 82.12 254.414 78.6534 256.707C74.4 259.294 70.1864 263.787 70.333 269.08C71.3996 271.16 72.7463 272.96 74.1328 274.826C75.7995 271.293 77.0135 265.786 80.4268 263.52C83.4399 261.6 86.1332 263.12 87.4532 266.106C86.2398 269.84 84.1869 273.32 82.5469 276.88C88.4801 276.907 93.8669 277.333 99.4268 274.8C103.507 273.12 106.587 270.373 108.28 266.24C113.08 254.774 111.48 241.893 113.08 230.8C113.693 226.96 117.799 227.773 120.626 228.106C132.946 230.24 145.24 231.919 157.693 233.093C160.04 233.533 164.066 233.547 165.053 236.24C165.973 240.067 165.133 244.454 164.88 248.36C164.427 251.494 164.4 255.28 162.814 258.08C158.614 263.187 150.826 265.146 148.786 272.093C147.306 276.199 150.506 277.973 152.6 280.946C153.72 277.413 154.147 271.107 157.786 269.08C160.466 267.374 163.053 269.133 163.8 271.866C163.507 275.026 162.147 278.147 161.28 281.2C162.907 281.6 164.547 281.987 166.187 282.387C167.28 277.72 167.613 271.453 172.573 269.106C175.6 268.213 176.84 269.24 178.64 271.547C177.933 275.427 175.627 279.094 174.08 282.707C181.053 281.454 189.133 280.493 193.04 273.707C198.427 263.534 199.04 249.68 201.106 238.52C201.507 236.586 202.334 234.893 204.427 234.467C209.133 233.734 214.186 234.534 218.946 234.707C251.386 236.227 283.88 236.573 316.333 235.786C321.221 235.718 326.11 235.631 331 235.526V244.725C290.684 245.39 250.083 245.876 209.906 243.213C208.32 253.893 207.039 265.44 202.786 275.439C199.479 283.186 192.333 288.107 184.293 289.96C176.72 291.653 168.68 291.707 160.986 290.88C154.52 289.933 146.84 288.12 142.467 282.854C137.92 277.347 138.853 269.093 142.88 263.573C146.053 259.173 150.56 257.12 154.333 253.587C155.506 250.027 155.493 245.987 155.88 242.267C144.453 241.2 133.146 239.373 121.826 237.573C121.186 247.92 121.08 259.986 116.96 269.64C114.627 275.36 110.373 280.12 104.72 282.733C97.5464 286.08 88.746 286.44 81.0127 285.453C74.6129 284.373 67.4134 282 63.4668 276.493C59.7468 270.92 60.6265 263.653 64.1465 258.213C68.2265 251.76 74.6535 248.44 81.0401 244.72C80.1201 225.387 79.1331 206.067 78.0664 186.733C68.1198 184.307 57.853 181.226 48.6397 176.68C36.4398 170.52 26.3194 160.88 21.3194 147.974C15.4395 145.547 10.0396 143.16 5.94632 138.04C-0.573606 130.12 -1.10664 118.747 1.87992 109.28C4.93325 99.8936 11.4933 91.2 17.3067 83.3067C26.3333 71.3733 34.9336 59.1336 43.5469 46.8936C51.1468 36.0403 60.7198 26.4803 71.6397 18.9736ZM35.3868 74.9463C29.1335 83.6796 22.2395 92.0395 16.4795 101.093C11.9862 108.439 8.25266 116.854 10.2793 125.627C11.4927 130.88 15.0137 133.813 18.5869 137.48C19.1469 132.013 19.3332 126.893 20.9864 121.627C23.5864 113.454 28.3193 106.413 30.626 98.0264C32.666 90.4531 33.6401 82.5996 35.3868 74.9463Z" fill="#F85E3F"/>
<path d="M124.373 134.094C127.373 133.787 130.187 135.48 130.667 138.547C130.814 141.72 128.64 145.08 127.04 147.693C116.453 163.387 96.3468 172.187 77.6269 169.12C70.6136 168.04 62.7194 166.001 57.0527 161.561C54.0394 158.721 54.3999 155.254 58.1465 153.36C61.3331 153.6 64.5331 155.347 67.4931 156.48C73.2265 158.934 79.427 160.2 85.667 160.12C98.1735 159.747 111.4 153.786 118.213 142.96C120.159 140.093 121.68 136.32 124.373 134.094ZM62.2803 112.413C72.7601 110.333 85.1729 110.774 93.0928 118.934C98.6528 124.387 98.4001 133.56 93.1601 139.134C86.8802 145.547 78.3199 147.133 69.6533 146.467C63.24 146.013 56.3598 143.533 51.7998 138.88C47.6932 134.6 46.2 128.16 48.6533 122.653C51.0933 117.093 56.587 113.826 62.2803 112.413ZM131.627 74.9599C134.92 74.1336 138.227 76.0405 139.547 79.0937C142.147 84.6936 141.466 93.093 136.693 97.373C132.4 100.373 127.159 97.5869 125.666 92.9736C123.493 87.2403 125.04 77.1999 131.627 74.9599ZM70.1465 74.8535C74.5597 73.9468 77.7727 77.1066 78.8262 81.1465C80.2261 86.413 79.5465 94.5996 74.4267 97.7998C69.5068 100.186 65.2397 96.7335 63.9863 91.9736C62.3063 86.4403 63.6799 76.7335 70.1465 74.8535Z" fill="#F85E3F"/>
</svg>
`;
  // Lazy import to avoid adding a direct dependency here
  const { SvgXml } = require('react-native-svg');
  return <View style={styles.container}><SvgXml xml={headSvg} width={160} height={120} /></View>;
};

const styles = StyleSheet.create({
  container: {
    margin: 0,
    padding: 0,
    width: 160,
    height: 120,
  },
  image: {
    width: 160,
    height: 120,
  },
});
